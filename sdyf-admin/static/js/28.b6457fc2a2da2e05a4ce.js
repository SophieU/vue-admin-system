webpackJsonp([28],{"+qbu":function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a={name:"staff-account",computed:{username:function(){var e=this.$store.state.app.staffAccount;return e?e.username:""}},data:function(){return{userId:"",queryType:"",disNormalUser:!0,normalUserInfo:{},disInfo:!0,baseInfo:{trueName:"",mobile:"",repairStationName:""},disService:!0,sysService:{serviceUserId:"",sysServiceProjectType:"",sysServiceProjectValue:"",sysMaterialProjectType:"",sysMaterialProjectValue:""},columns:[],orderLists:[],applyState:"",accountInfo:{applyState:0,applyRemark:"",accountsState:""},disBusiness:!0,businessState:""}},methods:{generateQrCode:function(){this.$http.get("/api/v1/user/makeInviteQr?userId="+this.userId).then(function(e){0===e.data.code&&console.log(e.data.data)})},getUserDetail:function(e){var s=this;this.$http.get("/yyht/v1/user/detail?userId="+e).then(function(e){0===e.data.code?s.normalUserInfo=e.data.data:console.log(e.data.msg)})},toggleNormal:function(){var e=this;if(this.disNormalUser)this.disNormalUser=!1;else{var s={userId:this.userId,userType:"",trueName:"",userState:"",commissionType:"",commissionValue:""};for(var t in s)s[t]=this.normalUserInfo[t];this.$http.post("/yyht/v1/user/changeUserMsg",s).then(function(s){0===s.data.code?(e.disNormalUser=!0,e.$Message.success("保存成功")):e.$Message.error("保存失败")})}},getDetail:function(e){var s=this;this.$http.get("/yyht/v1/service/user/detail?id="+e).then(function(e){if(0===e.data.code){var t=e.data.data;for(var a in s.userId=t.id,s.baseInfo)s.baseInfo[a]=t[a];for(var r in s.sysService)s.sysService[r]=t[r];for(var i in s.accountInfo)s.accountInfo[i]=t[i];s.businessState=t.businessState,s.applyState=t.applyState,console.log(e.data.data)}})},toggleService:function(){this.disService?this.disService=!this.disService:this.saveChange("sysService")},toggleBusiness:function(){var e=this;if(this.disBusiness)this.disBusiness=!1;else{var s="serviceUserId="+this.userId+"&businessState="+this.businessState;this.$http.post("/yyht/v1/service/user/change/businessState?"+s).then(function(s){0===s.data.code?(e.$Message.success("保存成功"),e.disBusiness=!0):e.$Message.info("保存失败")})}},saveChange:function(e,s){var t=this,a=void 0;"accountInfo"===e&&((a=this.accountInfo).serviceUserId=this.userId,"switch"===s&&(delete this.accountInfo.applyState,delete this.accountInfo.applyRemark)),"sysService"===e&&(a=this.sysService,this.sysService.serviceUserId=this.userId,parseFloat(this.sysService.sysServiceProjectType)&&parseFloat(this.sysService.sysServiceProjectType)||this.$Message.error("扣点值格式不正确，请重新输入数字")),this.$http.post("/yyht/v1/service/user/applyServiceUser",a).then(function(s){0===s.data.code?(t.$Message.success("状态更新成功"),t.getDetail(t.userId),"sysService"===e&&(t.disService=!0)):t.$Message.error("状态更新失败")})}},mounted:function(){this.userId=this.$route.query.id,this.queryType=this.$route.query.queryType,"service"===this.queryType?this.getDetail(this.userId):this.getUserDetail(this.userId)}},r={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("Card",["normal"===e.queryType?t("Form",{staticClass:"normal-form",attrs:{"label-width":80}},[t("div",{staticClass:"normal-left"},[t("div",{staticClass:"normal-title"},[e._v("基本信息\n\n        "),t("Button",{staticClass:"normal-btn",on:{click:e.generateQrCode}},[e._v("生成二维码")])],1),e._v(" "),t("div",{staticClass:"normal-table"},[t("div",{staticClass:"table-row"},[t("label",[e._v("用户姓名：")]),e._v(" "),t("span",[e._v(e._s(e.normalUserInfo.trueName))])]),e._v(" "),t("div",{staticClass:"table-row"},[t("label",[e._v("用户电话：")]),e._v(" "),t("span",[e._v(e._s(e.normalUserInfo.mobile))])]),e._v(" "),t("div",{staticClass:"table-row"},[t("label",[e._v("用户昵称：")]),e._v(" "),t("span",[e._v(e._s(e.normalUserInfo.nickName))])]),e._v(" "),t("div",{staticClass:"table-row"},[t("label",[e._v("微信Id：")]),e._v(" "),t("span",[e._v(e._s(e.normalUserInfo.wxXcxOpenId))])])])]),e._v(" "),t("div",{staticClass:"normal-right"},[t("div",{staticClass:"normal-title"},[e._v("\n        可变更信息\n        "),t("Button",{staticClass:"normal-btn",on:{click:e.toggleNormal}},[e._v(e._s(e.disNormalUser?"编辑":"保存"))])],1),e._v(" "),t("FormItem",{attrs:{label:"用户类型："}},[t("Select",{attrs:{disabled:e.disNormalUser},model:{value:e.normalUserInfo.userType,callback:function(s){e.$set(e.normalUserInfo,"userType",s)},expression:"normalUserInfo.userType"}},[t("Option",{attrs:{value:"USER"}},[e._v("普通用户")]),e._v(" "),t("Option",{attrs:{value:"ADMIN"}},[e._v("超级管理员")]),e._v(" "),t("Option",{attrs:{value:"SERVICE_USER"}},[e._v("系统用户")]),e._v(" "),t("Option",{attrs:{value:"MERCHANT"}},[e._v("商户类型")])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"会员状态"}},[t("i-switch",{attrs:{size:"large",disabled:e.disNormalUser,"true-value":"OPEN","false-value":"CLOSE"},model:{value:e.normalUserInfo.UserStateEnum,callback:function(s){e.$set(e.normalUserInfo,"UserStateEnum",s)},expression:"normalUserInfo.UserStateEnum"}},[t("span",{attrs:{slot:"open"},slot:"open"},[e._v("开启")]),e._v(" "),t("span",{attrs:{slot:"close"},slot:"close"},[e._v("关闭")])])],1),e._v(" "),t("FormItem",{attrs:{label:"分佣类型："}},[t("Select",{attrs:{disabled:e.disNormalUser},model:{value:e.normalUserInfo.commissionType,callback:function(s){e.$set(e.normalUserInfo,"commissionType",s)},expression:"normalUserInfo.commissionType"}},[t("Option",{attrs:{value:"FIXED"}},[e._v("固定金额型")]),e._v(" "),t("Option",{attrs:{value:"PERCENT"}},[e._v("按百分比型")]),e._v(" "),t("Option",{attrs:{value:"NONE"}},[e._v("无")])],1)],1),e._v(" "),[t("FormItem",{attrs:{label:"分佣值："}},[t("div",[t("InputNumber",{attrs:{disabled:e.disNormalUser},model:{value:e.normalUserInfo.commissionValue,callback:function(s){e.$set(e.normalUserInfo,"commissionValue",s)},expression:"normalUserInfo.commissionValue"}}),e._v(" "),e.normalUserInfo.commissionType?t("span",[e._v("%")]):t("span",[e._v("元")])],1)])]],2)]):e._e(),e._v(" "),"service"===e.queryType?t("Form",{staticClass:"form-wrap"},[t("div",{staticClass:"info-block mb-15"},[t("p",{staticClass:"info-title"},[t("span",[e._v("人员信息")])]),e._v(" "),t("div",{staticClass:"info-content"},[t("FormItem",{attrs:{label:"师傅姓名："}},[t("Input",{attrs:{readonly:""},model:{value:e.baseInfo.trueName,callback:function(s){e.$set(e.baseInfo,"trueName",s)},expression:"baseInfo.trueName"}})],1),e._v(" "),t("FormItem",{attrs:{label:"师傅电话："}},[t("Input",{attrs:{readonly:""},model:{value:e.baseInfo.mobile,callback:function(s){e.$set(e.baseInfo,"mobile",s)},expression:"baseInfo.mobile"}})],1),e._v(" "),t("FormItem",{attrs:{label:"服务网点："}},[t("Input",{attrs:{readonly:""},model:{value:e.baseInfo.repairStationName,callback:function(s){e.$set(e.baseInfo,"repairStationName",s)},expression:"baseInfo.repairStationName"}})],1)],1)]),e._v(" "),t("div",{staticClass:"info-block mb-15 "},[t("p",{staticClass:"info-title"},[e._v("师傅状态")]),e._v(" "),0==e.applyState?[t("div",{staticClass:"info-content"},[t("Alert",{attrs:{"show-icon":""}},[e._v("当前账号需要您先审核")]),e._v(" "),t("FormItem",{attrs:{label:"是否通过审核："}},[t("Select",{staticClass:"form-control",model:{value:e.accountInfo.applyState,callback:function(s){e.$set(e.accountInfo,"applyState",s)},expression:"accountInfo.applyState"}},[t("Option",{attrs:{value:"1"}},[e._v("是")]),e._v(" "),t("Option",{attrs:{value:"-1"}},[e._v("否")])],1)],1),e._v(" "),t("FormItem",{attrs:{label:"审核说明："}},[t("Input",{attrs:{type:"textarea"},model:{value:e.accountInfo.applyRemark,callback:function(s){e.$set(e.accountInfo,"applyRemark",s)},expression:"accountInfo.applyRemark"}})],1),e._v(" "),t("FormItem",[t("Button",{staticClass:"pull-right",attrs:{type:"primary"},on:{click:function(s){e.saveChange("accountInfo")}}},[e._v("保存")])],1)],1)]:[t("div",{staticClass:"info-content"},[t("FormItem",{attrs:{label:"账号状态设置"}},[t("i-switch",{attrs:{size:"large","true-value":"NORMAL","false-value":"DISABLE"},on:{"on-change":function(s){e.saveChange("accountInfo","switch")}},model:{value:e.accountInfo.accountsState,callback:function(s){e.$set(e.accountInfo,"accountsState",s)},expression:"accountInfo.accountsState"}},[t("span",{attrs:{slot:"open"},slot:"open"},[e._v("启用")]),e._v(" "),t("span",{attrs:{slot:"close"},slot:"close"},[e._v("停用")])])],1)],1)]],2),e._v(" "),0!==e.applyState?[t("div",{staticClass:"info-block mb-15"},[t("p",{staticClass:"info-title"},[t("span",[e._v("师傅扣点比例")]),e._v(" "),t("Button",{attrs:{type:e.disService?"default":"primary",size:"small"},on:{click:e.toggleService}},[e._v(e._s(e.disService?"编辑":"保存"))])],1),e._v(" "),t("div",{staticClass:"info-content"},[t("FormItem",{attrs:{label:"人工费扣点方式"}},[t("Select",{staticClass:"form-item",attrs:{disabled:e.disService},model:{value:e.sysService.sysServiceProjectType,callback:function(s){e.$set(e.sysService,"sysServiceProjectType",s)},expression:"sysService.sysServiceProjectType"}},[t("Option",{attrs:{value:"FIXED"}},[e._v("固定金额型")]),e._v(" "),t("Option",{attrs:{value:"PERCENT"}},[e._v("按百分比型")]),e._v(" "),t("Option",{attrs:{value:"NONE"}},[e._v("无")])],1)],1),e._v(" "),[t("FormItem",{attrs:{label:"人工费扣点值"}},[t("div",[t("InputNumber",{attrs:{disabled:e.disService},model:{value:e.sysService.sysServiceProjectValue,callback:function(s){e.$set(e.sysService,"sysServiceProjectValue",s)},expression:"sysService.sysServiceProjectValue"}}),e._v(" "),"PERCENT"===e.sysService.sysServiceProjectType?t("span",[e._v("%")]):t("span",[e._v("元")])],1)])],e._v(" "),t("FormItem",{attrs:{label:"材料费扣点方式"}},[t("Select",{staticClass:"form-item",attrs:{disabled:e.disService},model:{value:e.sysService.sysMaterialProjectType,callback:function(s){e.$set(e.sysService,"sysMaterialProjectType",s)},expression:"sysService.sysMaterialProjectType"}},[t("Option",{attrs:{value:"FIXED"}},[e._v("固定金额型")]),e._v(" "),t("Option",{attrs:{value:"PERCENT"}},[e._v("按百分比型")]),e._v(" "),t("Option",{attrs:{value:"NONE"}},[e._v("无")])],1)],1),e._v(" "),[t("FormItem",{attrs:{label:"材料费扣点值"}},[t("div",{staticClass:"form-item"},[t("InputNumber",{attrs:{disabled:e.disService},model:{value:e.sysService.sysMaterialProjectValue,callback:function(s){e.$set(e.sysService,"sysMaterialProjectValue",s)},expression:"sysService.sysMaterialProjectValue"}}),e._v(" "),"PERCENT"===e.sysService.sysServiceProjectType?t("span",[e._v("%")]):t("span",[e._v("元")])],1)])]],2)]),e._v(" "),t("div",{staticClass:"info-block mb-15"},[t("p",{staticClass:"info-title"},[t("span",[e._v("业务状态")]),e._v(" "),t("Button",{attrs:{size:"small",type:e.disBusiness?"default":"primary"},on:{click:e.toggleBusiness}},[e._v(e._s(e.disBusiness?"编辑":"保存"))])],1),e._v(" "),t("div",{staticClass:"info-content"},[t("FormItem",{attrs:{label:"业务状态调整"}},[t("Select",{staticClass:"form-item mb-15",attrs:{disabled:e.disBusiness},model:{value:e.businessState,callback:function(s){e.businessState=s},expression:"businessState"}},[t("Option",{attrs:{value:"NORMAL"}},[e._v("正常")]),e._v(" "),t("Option",{attrs:{value:"DISABLE_ACCEPT_REPAIR_ORDER"}},[e._v("禁止接工单")]),e._v(" "),t("Option",{attrs:{value:"DISABLE"}},[e._v("禁用账号")])],1)],1)],1)])]:e._e()],2):e._e()],1)},staticRenderFns:[]};var i=t("VU/8")(a,r,!1,function(e){t("Z2Qn")},"data-v-282c9fb4",null);s.default=i.exports},Z2Qn:function(e,s){}});