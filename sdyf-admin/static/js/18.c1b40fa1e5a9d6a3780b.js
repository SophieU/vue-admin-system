webpackJsonp([18],{Chc0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("TVG1"),s={name:"appeal",data:function(){return{before:[],after:[],afterSale:[],editingId:"",editingType:"",tempData:[]}},watch:{editingItem:{handler:function(t){console.log(t)},deep:!0}},methods:{editThis:function(t,e){""===this.editingId?this.editingId=this[t][e].id:this.$Message.info("请先保存正在编辑的内容")},addAppeal:function(t){if(t)if(""===this.editingId){var e={statementType:"",orderStateType:"",statementName:"",sortIndex:this[t].length+1};switch(t){case"before":e.statementType="ORDER",e.orderStateType="1";break;case"after":e.statementType="ORDER",e.orderStateType="2";break;case"afterSale":e.statementType="AFTER_SALE"}this[t].push(e),this.editingId="new"}else this.$Message.info("请先保存正在编辑的内容")},saveThis:function(t,e){var a=this,s=this[t][e],n=s.statementName;if(t&&this[t]instanceof Array){if(n.length<=0)return void this.$Message.info("请先填写申述原因再保存");if(!/^[A-Za-z0-9\u4e00-\u9fa5]+$/.test(n))return void this.$Message.info("申述原因不能含有特殊字符以及空格");this.editingId="";var r=i.a.formatterParams(s);this.$http.post("/yyht/v1/repair/statement/reason/addOrUpdate?"+r).then(function(t){0===t.data.code?(a.$Message.success("保存成功"),a.getLists()):a.$Message.error(t.data.msg)})}},delThis:function(t,e){var a=this;if(t){var i=this[t][e].id;this.$http.get("/yyht/v1/repair/statement/reason/delete?id="+i).then(function(t){0===t.data.code?(a.$Message.success("删除成功"),a.getLists()):a.$Message.error(t.data.msg)})}},getLists:function(){var t=this;this.$http.get("/yyht/v1/repair/statement/reason/list").then(function(e){if(0===e.data.code){var a=e.data.data;t.tempData=a,t.formateData(a)}})},formateData:function(t){this.editingId="";var e=[],a=[],i=[];t.forEach(function(t){"AFTER_SALE"===t.statementType?e.push(t):"ORDER"===t.statementType&&"1"===t.orderStateType?a.push(t):"ORDER"===t.statementType&&"2"===t.orderStateType&&i.push(t)}),this.afterSale=e,this.before=a,this.after=i,this.editingId=""}},mounted:function(){this.getLists()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("Row",{attrs:{gutter:40}},[a("Col",{staticClass:"column",attrs:{span:"8"}},[a("div",{staticClass:"column-header clearfix mb-15"},[a("h3",{staticClass:"pull-left"},[t._v("申述原因（上门前）")]),t._v(" "),a("Button",{staticClass:"pull-right",attrs:{type:"primary"},on:{click:function(e){t.addAppeal("before")}}},[t._v("新增")])],1),t._v(" "),a("div",{staticClass:"column-body mt-15"},t._l(t.before,function(e,i){return a("div",{key:i,staticClass:"appeal-item"},[a("Input",{staticClass:"appeal-input",attrs:{maxlength:20,disabled:t.editingId!==e.id&&!!e.id},model:{value:e.statementName,callback:function(a){t.$set(e,"statementName",a)},expression:"item.statementName"}}),t._v(" "),a("div",{staticClass:"btn-groups"},[e.id&&t.editingId!==e.id?[a("Button",{on:{click:function(e){t.editThis("before",i)}}},[t._v("编辑")]),t._v(" "),a("Button",{attrs:{type:"error"},on:{click:function(e){t.delThis("before",i)}}},[t._v("删除")])]:t._e(),t._v(" "),e.id&&t.editingId!==e.id?t._e():[a("Button",{attrs:{type:"success"},on:{click:function(e){t.saveThis("before",i)}}},[t._v("保存")]),t._v(" "),a("Button",{on:{click:function(e){t.formateData(t.tempData)}}},[t._v("取消")])]],2)],1)}))]),t._v(" "),a("Col",{staticClass:"column",attrs:{span:"8"}},[a("div",{staticClass:"column-header clearfix mb-15"},[a("h3",{staticClass:"pull-left"},[t._v("申述原因（上门后）")]),t._v(" "),a("Button",{staticClass:"pull-right",attrs:{type:"primary"},on:{click:function(e){t.addAppeal("after")}}},[t._v("新增")])],1),t._v(" "),a("div",{staticClass:"column-body mt-15"},t._l(t.after,function(e,i){return a("div",{key:i,staticClass:"appeal-item"},[a("Input",{staticClass:"appeal-input",attrs:{maxlength:20,disabled:t.editingId!==e.id&&!!e.id},model:{value:e.statementName,callback:function(a){t.$set(e,"statementName",a)},expression:"item.statementName"}}),t._v(" "),a("div",{staticClass:"btn-groups"},[e.id&&t.editingId!==e.id?[a("Button",{on:{click:function(e){t.editThis("after",i)}}},[t._v("编辑")]),t._v(" "),a("Button",{attrs:{type:"error"},on:{click:function(e){t.delThis("after",i)}}},[t._v("删除")])]:t._e(),t._v(" "),e.id&&t.editingId!==e.id?t._e():[a("Button",{attrs:{type:"success"},on:{click:function(e){t.saveThis("after",i)}}},[t._v("保存")]),t._v(" "),a("Button",{on:{click:function(e){t.formateData(t.tempData)}}},[t._v("取消")])]],2)],1)}))]),t._v(" "),a("Col",{staticClass:"column",attrs:{span:"8"}},[a("div",{staticClass:"column-header clearfix mb-15"},[a("h3",{staticClass:"pull-left"},[t._v("申述原因（售后）")]),t._v(" "),a("Button",{staticClass:"pull-right",attrs:{type:"primary"},on:{click:function(e){t.addAppeal("afterSale")}}},[t._v("新增")])],1),t._v(" "),a("div",{staticClass:"column-body mt-15"},t._l(t.afterSale,function(e,i){return a("div",{key:i,staticClass:"appeal-item"},[a("Input",{staticClass:"appeal-input",attrs:{maxlength:20,disabled:t.editingId!==e.id&&!!e.id},model:{value:e.statementName,callback:function(a){t.$set(e,"statementName",a)},expression:"item.statementName"}}),t._v(" "),a("div",{staticClass:"btn-groups"},[e.id&&t.editingId!==e.id?[a("Button",{on:{click:function(e){t.editThis("afterSale",i)}}},[t._v("编辑")]),t._v(" "),a("Button",{attrs:{type:"error"},on:{click:function(e){t.delThis("afterSale",i)}}},[t._v("删除")])]:t._e(),t._v(" "),e.id&&t.editingId!==e.id?t._e():[a("Button",{attrs:{type:"success"},on:{click:function(e){t.saveThis("afterSale",i)}}},[t._v("保存")]),t._v(" "),a("Button",{on:{click:function(e){t.formateData(t.tempData)}}},[t._v("取消")])]],2)],1)}))])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(s,n,!1,function(t){a("sJdp")},"data-v-625ffede",null);e.default=r.exports},sJdp:function(t,e){}});